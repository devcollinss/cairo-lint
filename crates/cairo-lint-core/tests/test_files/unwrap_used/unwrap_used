// Test: no unwrap used
//! > cairo_code
fn main() {
  let x = Some(5);
  let y = x.expect("Value should exist");
}
//! > diagnostics
//! > fixed
fn main() {
  let x = Some(5);
  let y = x.expect("Value should exist");
}

// Test: simple unwrap used
//! > cairo_code
fn main() {
  let x = Some(5);
  let y = x.unwrap(); // This should be replaced
}
//! > diagnostics
// Note: Modify to expect a meaningful message
//! > fixed
fn main() {
  let x = Some(5);
  let y = x.expect("Value should exist");
}

// Test: multiple unwraps used
//! > cairo_code
fn main() {
  let x = Some(5);
  let y = Some("hello");
  let a = x.unwrap();
  let b = y.unwrap();
}
//! > diagnostics
warning: Plugin diagnostic: Use of unwrap() detected. Consider using '?' or 'expect()' instead.
--> lib.cairo:4:13
|
4 |     let a = x.unwrap();
|             ^^^^^^^^^^
//! > fixed
fn main() {
  let x = Some(5);
  let y = Some("hello");
  let a = x.expect("Value should exist");
  let b = y.expect("Value should exist");
}

// Test: Unwrap in a nested function
//! > cairo_code
fn main() {
  fn inner_function() -> u32 {
    Some(42).unwrap()
  }

  let result = inner_function();
}
//! > diagnostics
warning: Plugin diagnostic: Use of unwrap() detected. Consider using '?' or 'expect()' instead.
--> lib.cairo:6:13
|
6 |     Some(42).unwrap()
|                ^^^^^^
//! > fixed
fn main() {
  fn inner_function() -> u32 {
    Some(42).expect("Value should exist")
  }

  let result = inner_function();
}

// Test: Unwrap in a method chain
//! > cairo_code
fn main() {
  let x = vec![1, 2, 3];
  let first = x.first().unwrap();
}
//! > diagnostics
warning: Plugin diagnostic: Use of unwrap() detected. Consider using '?' or 'expect()' instead.
--> lib.cairo:4:13
|
4 |     let first = x.first().unwrap();
|                       ^^^^^^^^^^
//! > fixed
fn main() {
  let x = vec![1, 2, 3];
  let first = x.first().expect("Vec should not be empty");
}

// Test: Unwrap with a different variable name
//! > cairo_code
fn main() {
  let unwrap_me = Some("test");
  let result = unwrap_me.unwrap();
}
//! > diagnostics
warning: Plugin diagnostic: Use of unwrap() detected. Consider using '?' or 'expect()' instead.
--> lib.cairo:4:13
|
4 |     let result = unwrap_me.unwrap();
|                          ^^^^^^^^^^
//! > fixed
fn main() {
  let unwrap_me = Some("test");
  let result = unwrap_me.expect("Value should exist");
}

// Test: Unwrap in a complex expression
//! > cairo_code
fn main() {
  let x = Some(5);
  let y = Some(10);
  let result = x.unwrap() + y.unwrap() * 2;
}
//! > diagnostics
warning: Plugin diagnostic: Use of unwrap() detected. Consider using '?' or 'expect()' instead.
--> lib.cairo:5:13
|
5 |     let result = x.unwrap() + y.unwrap() * 2;
|                          ^^^^^^^^^^
//! > fixed
fn main() {
  let x = Some(5);
  let y = Some(10);
  let result = x.expect("Value should exist") + y.expect("Value should exist") * 2;
}
